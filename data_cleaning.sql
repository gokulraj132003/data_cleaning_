create database icecream;
use icecream;
CREATE TABLE company
(  company_id int(11) NOT NULL,
  company_name varchar(500) NOT NULL,
  company_gst varchar(100) NOT NULL,
  company_address varchar(100) NOT NULL,
  company_contact_number varchar(11) NOT NULL,
  company_logo varchar(100) NOT NULL,
  company_landing_image varchar(100) NOT NULL,
  company_website varchar(100) NOT NULL,
  company_email varchar(100) NOT NULL)
ENGINE=InnoDB DEFAULT CHARSET=latin1;
show tables;
describe company;

select * from company;
INSERT INTO company (company_id, company_name, company_gst, company_address, company_contact_number, company_logo, company_landing_image, company_website, company_email) VALUES
(7, 'Irish Dairy ', '32AMPPA0459E1ZH', 'Machiplavu, Machiplavu PO, Chattupara, Adimali, Idukki - 685561, FSSAI No : 11315006000401', '9562257755', '772198145c3b737a01f06b3d7df1d276.png', '', '', '');

CREATE TABLE orders (
  orders_id int(11) NOT NULL,
  order_uniqueid text NOT NULL,
  orders_shops_id int(11) NOT NULL,
  orders_advc_amount double NOT NULL,
  orders_pend_amount double NOT NULL,
  mode_of_payment varchar(25) NOT NULL,
  order_status_id int(11) NOT NULL,
  orders_delivery_boy int(11) NOT NULL,
  orders_addedby int(11) NOT NULL,
  orders_addedon timestamp NOT NULL DEFAULT current_timestamp() ON UPDATE current_timestamp(),
  created_on datetime NOT NULL DEFAULT current_timestamp(),
  updated_on datetime NOT NULL DEFAULT current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=latin1;
describe orders;
INSERT INTO orders (orders_id, order_uniqueid, orders_shops_id, orders_advc_amount, orders_pend_amount, mode_of_payment, order_status_id, orders_delivery_boy, orders_addedby, orders_addedon, created_on, updated_on) VALUES
(1, '61f772dcaef16', 1, 310.5, 21, 'By Cash', 4, 0, 13, '2022-01-31 05:31:11', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(2, '61f773afb0cf5', 1, 115, 32, 'By Cash', 5, 0, 13, '2022-01-31 05:45:12', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(3, '61f7771433f1f', 1, 185, 11, 'By Cash', 4, 0, 13, '2022-01-31 05:49:37', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(4, '61fb978b667d1', 1, 500, 0, '', 1, 0, 11, '2022-02-03 08:53:15', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(6, '61fcac7b48703', 2, 944, 54, 'By Cash', 5, 0, 11, '2023-10-19 12:29:29', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(7, '650aa0f9dc7bc', 33, 0, 50, '', 0, 0, 5, '2023-09-20 07:36:32', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(8, '650aa11e0ea96', 34, 0, 200, '', 0, 0, 5, '2023-09-20 07:37:22', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(9, '650aa17705d7c', 32, 450, 3000, 'By Cash', 4, 0, 1, '2024-06-28 10:43:24', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(10, '650aa1cf1fec6', 32, 100, 0, '', 5, 0, 1, '2023-09-20 07:40:24', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(11, '650aa250bc90c', 32, 0, 0, '', 4, 0, 8, '2023-09-20 07:42:17', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(12, '650aa38dac9e7', 32, 0, 0, '', 5, 0, 1, '2023-09-20 07:48:27', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(13, '652675a6c5a17', 2, 0, 0, '', 4, 0, 1, '2023-10-11 10:15:26', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(14, '65267ca799afa', 0, 0, 0, '', 1, 0, 1, '2023-10-11 10:45:03', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(15, '652ce7c4a206e', 2, 0, 0, '', 1, 0, 1, '2023-10-16 07:35:42', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(16, '652cf30b78d7b', 0, 0, 0, '', 1, 0, 1, '2023-10-16 08:23:56', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(17, '652cf2fe44394', 1, 0, 0, '', 1, 0, 1, '2023-10-16 08:24:15', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(18, '652cf8b03da29', 0, 0, 0, '', 1, 0, 1, '2023-10-16 08:47:49', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(19, '652d04d86edb8', 32, 0, 0, '', 1, 0, 1, '2023-10-16 09:40:01', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(20, '652d120abf9db', 1, 0, 0, '', 1, 0, 1, '2023-10-16 10:36:03', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(21, '652d133e8cd29', 0, 0, 0, '', 1, 0, 1, '2023-10-16 10:41:04', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(22, '652d1317cb35d', 0, 0, 0, '', 1, 0, 1, '2023-10-16 10:47:51', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(23, '652d159850bdf', 0, 0, 0, '', 1, 0, 1, '2023-10-16 10:51:06', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(24, '652df2a6d49e7', 1, 0, 0, '', 1, 0, 1, '2023-10-17 02:34:23', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(25, '652e6bc344ac7', 1, 0, 0, '', 1, 0, 1, '2023-10-17 11:11:06', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(26, '652e6beeb0e4b', 1, 0, 0, '', 1, 0, 1, '2023-10-17 11:11:52', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(27, '652f7348e1bec', 35, 0, 0, '', 1, 0, 1, '2023-10-18 05:55:43', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(28, '652f742ab3945', 35, 200, 0, '', 1, 0, 1, '2023-10-18 06:00:21', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(29, '652f762f1f60d', 35, 0, 0, '', 1, 0, 18, '2023-10-18 06:07:53', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(30, '652f7691ea336', 36, 0, 300, '', 0, 0, 0, '2023-10-18 06:09:33', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(31, '652f76f73a2a8', 37, 0, 280, '', 0, 0, 0, '2023-10-18 06:12:40', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(32, '652f9a495ad05', 1, 0, 0, '', 1, 0, 1, '2023-10-18 08:41:51', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(33, '652fdd9488722', 39, 0, 200, '', 0, 0, 0, '2023-10-18 13:29:02', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(34, '65311ed3bca95', 32, 0, 0, '', 1, 0, 1, '2023-10-19 12:19:45', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(35, '65312156140e6', 1, 400, 0, '', 1, 0, 1, '2023-10-19 12:30:40', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(36, '653121966a7a0', 32, 5000, 0, 'By Cash', 4, 0, 1, '2023-10-19 12:43:45', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(37, '65312e29b8929', 32, 0, 0, '', 1, 0, 1, '2023-10-19 13:25:12', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(38, '6531409ce02d2', 40, 0, 0, '', 0, 0, 0, '2023-10-19 14:43:44', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(39, '653140e1463a9', 41, 0, 140, '', 0, 0, 0, '2023-10-19 14:44:55', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(40, '65314203c62cf', 42, 0, 0, '', 0, 0, 0, '2023-10-19 14:50:21', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(41, '65323ae1d70df', 1, 0, 0, '', 1, 0, 1, '2023-10-20 08:31:36', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(42, '65323b06251c5', 1, 0, 0, '', 1, 0, 1, '2023-10-20 08:32:14', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(43, '65323bc13ec54', 1, 0, 0, '', 1, 0, 1, '2023-10-20 08:35:28', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(44, '65324abb3b2d6', 2, 0, 0, '', 1, 0, 1, '2023-10-20 09:39:12', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(45, '65334ca420f45', 0, 0, 0, '', 1, 0, 1, '2023-10-21 04:03:19', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(46, '65334f4fa8097', 2, 0, 0, '', 1, 0, 1, '2023-10-21 04:11:04', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(47, '653378249e0cf', 1, 0, 0, '', 1, 0, 1, '2023-10-21 07:05:11', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(48, '6533782d98510', 2, 0, 0, '', 1, 0, 1, '2023-10-21 07:05:21', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(49, '6533828fa7774', 2, 126, 0, '', 1, 0, 1, '2023-10-21 07:50:16', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(50, '666974e674208', 2, 0, 0, '', 1, 0, 1, '2024-06-12 10:14:10', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(51, '6669750f1cbc5', 2, 0, 0, '', 1, 0, 1, '2024-06-12 11:01:06', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(52, '66698096d56bd', 44, 0, 0, '', 1, 0, 1, '2024-06-12 11:04:00', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(53, '666bfa422296b', 32, 0, 0, '', 1, 0, 1, '2024-06-14 08:07:35', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(54, '666bfaaa2ec60', 2, 0, 0, '', 1, 0, 1, '2024-06-14 08:09:36', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(55, '666bff981e045', 45, 0, 80, '', 0, 0, 0, '2024-06-14 08:30:28', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(56, '666c00eced97f', 2, 0, 0, '', 1, 0, 1, '2024-06-14 08:36:06', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(57, '666c0105a8302', 2, 0, 0, '', 1, 0, 1, '2024-06-14 08:36:35', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(58, '666c017a2bd00', 2, 0, 0, '', 1, 0, 1, '2024-06-14 08:38:21', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(59, '666c019f488e0', 2, 0, 0, '', 1, 0, 1, '2024-06-14 08:38:59', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(60, '666c026edecf4', 2, 0, 0, '', 1, 0, 1, '2024-06-14 08:42:25', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(61, '666c02a70c335', 2, 0, 0, '', 1, 0, 1, '2024-06-14 08:43:21', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(62, '666c02e4c5dd9', 2, 0, 0, '', 1, 0, 1, '2024-06-14 08:44:23', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(63, '666c040d17b68', 2, 0, 0, '', 1, 0, 1, '2024-06-14 08:49:20', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(64, '666c045cc043e', 2, 0, 0, '', 1, 0, 1, '2024-06-14 08:50:39', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(65, '666c045cc043e', 2, 0, 0, '', 1, 0, 1, '2024-06-14 08:51:39', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(66, '666c045cc043e', 2, 0, 0, '', 1, 0, 1, '2024-06-14 08:51:56', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(67, '666c04f79e543', 2, 0, 0, '', 1, 0, 1, '2024-06-14 08:53:14', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(68, '666c05240460c', 2, 0, 0, '', 1, 0, 1, '2024-06-14 08:54:15', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(69, '666c058c69b06', 1, 0, 0, '', 1, 0, 1, '2024-06-14 08:55:50', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(70, '666c2f33d2b8c', 0, 0, 0, '', 1, 0, 1, '2024-06-14 11:53:28', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(71, '666c2f3be4fc0', 1, 0, 0, '', 1, 0, 1, '2024-06-14 11:53:39', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(72, '666e95e05368d', 1, 0, 0, '', 1, 0, 1, '2024-06-16 07:36:08', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(73, '666e960c756a7', 32, 0, 0, '', 1, 0, 1, '2024-06-16 07:36:50', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(74, '666e9631e27db', 32, 0, 0, '', 4, 0, 1, '2024-06-18 09:16:22', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(75, '66725461a2c3b', 1, 0, 0, '', 1, 0, 1, '2024-06-19 03:45:50', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(76, '6672565a2156d', 0, 0, 0, '', 1, 0, 1, '2024-06-19 03:55:19', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(77, '667256b1add62', 0, 0, 0, '', 1, 0, 1, '2024-06-19 03:55:41', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(78, '667258aaa175d', 1, 0, 0, '', 1, 0, 1, '2024-06-19 04:04:22', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(79, '667258dd69996', 1, 0, 0, '', 1, 0, 1, '2024-06-19 04:05:07', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(80, '66725a725900c', 1, 0, 0, '', 1, 0, 1, '2024-06-19 04:12:02', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(81, '66725aa1cf087', 1, 0, 0, '', 1, 0, 1, '2024-06-19 04:12:28', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(82, '66725ed2ed20c', 1, 0, 0, '', 2, 0, 1, '2024-06-20 10:29:13', '2024-06-20 13:58:37', '2024-06-20 13:58:37'),
(83, '6673eb8887b4d', 1, 0, 0, '', 1, 0, 1, '2024-06-20 08:43:02', '2024-06-20 14:13:02', '2024-06-20 14:13:02'),
(84, '66740264398ee', 1, 0, 0, '', 3, 0, 1, '2024-06-20 10:45:28', '2024-06-20 15:50:38', '2024-06-20 15:50:38'),
(85, '6679630052a08', 1, 0, 0, '', 1, 0, 22, '2024-06-24 12:14:25', '2024-06-24 17:44:25', '2024-06-24 17:44:25'),
(86, '667bb4634f417', 47, 0, 250, '', 0, 0, 0, '2024-06-26 06:25:55', '2024-06-26 11:55:55', '2024-06-26 11:55:55'),
(87, '667bb53349e6b', 2, 0, 0, '', 1, 0, 1, '2024-06-26 06:29:30', '2024-06-26 11:59:30', '2024-06-26 11:59:30'),
(88, '667c40d155f0e', 2, 0, 0, '', 1, 0, 1, '2024-06-26 16:24:58', '2024-06-26 21:54:58', '2024-06-26 21:54:58'),
(89, '667c40e42bb75', 1, 0, 0, '', 1, 0, 1, '2024-06-26 16:25:21', '2024-06-26 21:55:21', '2024-06-26 21:55:21');
select * from orders;
select orders_id, order_uniqueid, orders_shops_id, SUM(orders_advc_amount) AS total_advc_amount, SUM(orders_pend_amount) AS total_pend_amount, mode_of_payment, order_status_id, orders_delivery_boy, orders_addedby, orders_addedon, created_on, updated_on
from orders
where order_status_id = 4
group by orders_id, order_uniqueid, orders_shops_id, mode_of_payment, order_status_id, orders_delivery_boy, orders_addedby, orders_addedon, created_on, updated_on;


select orders_shops_id, COUNT(orders_shops_id) AS 'count', SUM(orders_pend_amount) AS 'total of pending', SUM(orders_advc_amount) AS 'total of advance' , order_status_id
from orders 
where order_status_id = 4 or (order_status_id = 5 and orders_pend_amount> 0)
group by orders_shops_id;


select orders_shops_id, count(orders_shops_id) as 'count',sum(orders_pend_amount) as 'total of pending' ,sum(orders_advc_amount) as 'total of advance' from orders 
where (order_status_id = 4)or (order_status_id = 5 and orders_pend_amount> 0)
group  by orders_shops_id;

SELECT 
    orders_shops_id, 
    COUNT(orders_shops_id) AS 'count', 
    SUM(orders_pend_amount) AS 'total of pending', 
    SUM(orders_advc_amount) AS 'total of advance'
FROM 
    orders 
WHERE 
    (order_status_id = 4) OR 
    (order_status_id = 5 AND orders_pend_amount > 0)
GROUP BY 
    orders_shops_id
HAVING 
    count(CASE WHEN order_status_id = 4 THEN 1 END) = 7;
-- ------------------------------------------------------------------
-- ------------------------------------------------------------------
select orders_shops_id, count(case when order_status_id = 4 then 1 end) as 'count', sum(orders_pend_amount) as 'total of pending', sum(orders_advc_amount) as 'total of advance' 
from orders 
where (order_status_id = 4) or (order_status_id = 5 and orders_pend_amount > 0)
group by orders_shops_id
having count(case when order_status_id = 4 then 1 end) = 4 or 5;
